== Konfiguracja testowego vm ==

=== Dlaczego sendmail uruchamia się tak długo? ===
Próbuje on rozwiązać nazwę hosta tm11201.localdomain i czeka na timeout DNS, którym jest w tym momencie serwer na którym działa klient vmplayer'a.

Aby mu pomóc określ aktualne IP maszyny wirtualnej
{{{
# ifconfig eth0
eth0      Link encap:Ethernet  HWaddr 00:0C:29:3B:E4:25  
          inet addr:192.168.211.174  Bcast:192.168.211.255  
}}}

I taki adres IP wstaw do pliku /etc/hosts, w tym przypadku:
{{{
# vi /etc/hosts
192.168.211.174 tm11201.localdomain tm11201
}}}

=== Zmiana rozdzielczości ekranu pod vmware ===


=== Tworzenie bazy danych ===

Zaloguj się jako oracle na serwer bazodanowy

Potwierdź dostępność narzędzia tworzącego bazę
{{{
$ which dbca
~/db/11.2.0.1/bin/dbca
}}}

Zwolnijmy miejsce na filesystemie
{{{
$ cd /BACKUP/
$ rm arch_*
$ rm db_*
}}}

Utwórzmy pusty katalog na nową bazę
{{{
# mkdir /JASIO
$ id -a
uid=600(oracle) gid=600(dba) groups=600(dba)
# chown oracle:dba /JASIO
$ touch /JASIO/ala_ma_kota
}}}

Upwnij się, że jest wystarczająco dużo wolnego miejsca
{{{
$ df -h
/dev/sda2              18G   14G  3.1G  82% /
}}}

Przy uzyciu kreatora:
{{{
$ dbca
}}}

Strona kodowa: EE8ISO8859P2
/ORABIN/db/admin/JASIO/scripts

Jakie bazy działają na serwerze
{{{
$ ps -ef | grep pmon
}}}

Jak została utworzona moja baza
{{{
alter database backup controlfile to trace;
}}}

Tworzenie spfile z inita
{{{
create spfile from pfile;
startup force 
}}}

*Zadanie 1: Zrestartuj bazy danych JASIO i CZESIODBCA jednocześnie podglądając plik alertlog.*

Ustalenie zmiennych środowiskowych dla konkretnej bazy danych
{{{
$ env | grep ORA
$ cat /etc/oratab
$ . oraenv
}}}

Określenie położenia pliku alert log
{{{
> show parameter dump
background_dump_dest /ORABIN/db/diag/rdbms/jasio/JASIO/trace
}}}

*Zadanie 2: Utwórz 3 grupy redo o wielkości 100M i skasuj stare, w tej samej lokalizacji tylko o innej nazwie*
{{{
> column MEMBER format a50
select * from v$logfile;
select GROUP#,BYTES,STATUS from sys.v$log;

> alter database add logfile group 4 ('/JASIO/oradata/redo100M6a.rdo') size 100M;
> alter database drop logfile group 1;

> alter system switch logfile;
> alter system checkpoint;
}}}

*Zadanie 3: Przełącz bazę w tryb archivelog*
{{{
> select LOG_MODE from v$database;

> show parameter log_archive_dest_1
$ mkdir -p /JASIO/arch
> alter system set log_archive_dest_1='location=/JASIO/arch';
> shutdown immediate
> startup mount
> alter database archivelog;
> alter database open;
> alter system switch logfile;
}}}

*Zadanie 4: Sytuacja awaryjna: Baza nie uruchamia się ze względu na błędną wartość parametru inicjalizacyjnego*
{{{
> alter system set log_archive_format='log_%S.arc' scope=spfile;
> startup force
ORA-19905: log_archive_format must contain %s, %t and %r

> create pfile from spfile;
> shutdown immediate
$ cd $ORACLE_HOME/dbs
$ env | grep ORACLE_SID
ORACLE_SID=JASIO
$ mv spfileJASIO.ora spfileJASIO.ora.bck1
$ vi initJASIO.ora
*.log_archive_format='log_%S_%t_%r.arc'
> startup
> show parameter spfile
NAME				     TYPE	 VALUE
------------------------------------ ----------- --------
spfile				     string
> create spfile from pfile;
> startup force
> show parameter spfile

NAME				     TYPE	 VALUE
------------------------------------ ----------- ----------
spfile				     string	 /ORABIN/db/11.2.0.1/dbs/spfile
						 JASIO.ora
}}}

*Zadanie 5: Zmiana położenia plików bazy danych*
{{{
Zmiana przeprowadzana jest poleceniem:
> alter database rename file '/disk1/file1' to '/disk2/file1';

Przygotuj komendy do zmiany na działającej bazie
> select name from v$datafile;

> spool rename.sql
> select 'alter database rename file '''||name||''' to '''||REPLACE(name,'JASIO','KASIA')||'''; ' from v$datafile;
> spool off

Zamknij bazę 
> shutdown immediate

Fizycznie przesuń pliki
# mkdir /KASIA
# chown oracle:dba /KASIA
$ mkdir /KASIA/KASIA
> startup mount
> @rename.sql

}}}