= Installing Oracle E-Business Suite Release 12.1.1 under OEL 5.8 =
== OS general guidelines ==
Unofficial install guides
  * http://www.oraclenerd.com/2009/12/ebs-install-guide-part-1.html
  * http://gerardnico.com/wiki/ebs/installation

Nice links
  * Oracle Applications System Administration Scripts [ID 214088.1]
  * 761566.1 Oracle E-Business Suite Installation and Upgrade Notes Release 12 (12.1.1) for Linux x86-64

Install Oracle Enterprise Linux 5.8 64-bit
  * no firewall,
  * selinux disabled,
  * IPv6 disabled
  * 8G RAM,
  * 250G HDD available, after installation media is unpacked. Media + unpack + installation requires ~ 450G

User and Group
{{{
# groupadd oinstall
# groupadd dba
# useradd -d /home/oracle -g oinstall -G dba -s /bin/bash oracle
}}}

== annoying free space missing from 250G? ==

It is OK. Linux by default reserves 5% of each partition for the root user. With ext4 filesystems you can check the amount of reserved blocks with

{{{
# tune4fs -l /dev/sdb1 | grep -i "block count"
}}}

How to release this reserve to all?

{{{
# tune4fs -m 0 /dev/sda1
}}}




== OS setup not required ==
Some OS setup checks I have automated, and run through scripts. I say about it because I do it and want describe the whole procedure exactly how I did it, but they are not required. What is dangerous is that I place my public key in .ssh to allow passwordless connection and install vmware tools because I do it under ESX. You probably do not want to do this :)

All the scripts are available under public SVN repository, created during http://code.google.com/p/oracleinfrastructure/ project. I use it for other purposes also. Feel free of cource to use it for your own good, if you find any errors please let me know.

After clean OEL installation I just need the 'svn' binary to download the mentioned scripts. For that I need a working yum repository, I will use reely available Oracle repository.

Enable Oracle yum repository, http://public-yum.oracle.com/
{{{
# cd /etc/yum.repos.d
# wget http://public-yum.oracle.com/public-yum-el5.repo
}}}

Now I can install SVN
{{{
# yum install subversion
}}}

{{{
# cd
# svn checkout https://oracleinfrastructure.googlecode.com/svn/trunk/scripto scripto
}}}

Now this is my unusual IP, domain, public key, vmware tools, etc. setup
{{{
# cd ~/scripto/linux/
# ./linux_setup.sh ALL
(repeated few times untill no reboots are required)
}}}




== OS preparation as per MOS 761566.1 ==

Oracle yum repository, http://public-yum.oracle.com/ (if not done before)
{{{
# cd /etc/yum.repos.d
# wget http://public-yum.oracle.com/public-yum-el5.repo
# vim public-yum-el5.repo
Change enabled=0 to enabled=1 in ol5_u8_base
}}}

{{{
# vi /etc/hosts
  #2.168.1.112   jazz.remik.org  jazz            # EBS 12.1.1 on OEL 5.8
}}}

{{{
# vi /etc/sysconfig/network
NETWORKING=yes
NETWORKING_IPV6=no
HOSTNAME=jazz.remik.org
# reboot
}}}

== Following 761566.1 Oracle E-Business Suite Installation and Upgrade Notes Release 12 (12.1.1) for Linux x86-64 ==

Download from
http://oss.oracle.com/projects/compat-oracle/files/Enterprise_Linux/
{{{
# yum install libXp.so.6
# rpm -Uvh openmotif21-2.1.30-11.EL5.i386.rpm
# rpm -Uvh xorg-x11-libs-compat-6.8.2-1.EL.33.0.1.i386.rpm
}}}

{{{
# yum install --nogpgcheck gcc gcc-c++ glibc glibc.i686 glibc-common glibc-devel glibc-devel.i386 libgcc libgcc.i386 libstdc++-devel libstdc++-devel.i386 libstdc++ libstdc++.i386 make gdbm gdbm.i386 libXp libXp.i386 libaio libaio.i386 libgomp sysstat util-linux compat-libstdc++-296 compat-libstdc++-33
}}}

{{{
# yum install --nogpgcheck compat-libstdc++-33 elfutils-libelf-devel elfutils-libelf-devel-static libaio-devel unixODBC.i386 unixODBC-devel.i386 unixODBC unixODBC-devel kernel-headers
# ldconfig -v
}}}

{{{
# yum install oracle-validated
# passwd oracle
}}}


== OS Library Patch for Oracle HTTP Server (on Oracle Linux 5, RHEL 5, Oracle Linux 6 and RHEL 6 only) ==

Install patch 6078836
{{{
# md5sum p6078836_101330_LINUX.zip
33281645539e5225c8b83d827469def4  p6078836_101330_LINUX.zip
# unzip p6078836_101330_LINUX.zip
# mv /usr/lib/libdb.so.2 /usr/lib/libdb.so.2.6078836
mv: cannot stat `/usr/lib/libdb.so.2': No such file or directory
# cd 6078836
# cp libdb.so.2 /usr/lib
}}}

== Link to Motif library in Oracle Application Server 10.1.2 (on Oracle Linux 5, RHEL 5, Oracle Linux 6 and RHEL 6 only) ==
{{{
# unlink /usr/lib/libXtst.so.6
# ln -s /usr/X11R6/lib/libXtst.so.6.1 /usr/lib/libXtst.so.6
}}}


== Unpack the downloaded EBS ==

Download EBS binaries to /u01/stageR12/
{{{
# cd /u01/stageR12/
# ls *.zip
B53824-01_1of4.zip  V15680-01_2of3.zip  V15683-01_2of3.zip  V15686-01_2of3.zip  V15690-01_2of3.zip
B53824-01_2of4.zip  V15680-01_3of3.zip  V15683-01_3of3.zip  V15686-01_3of3.zip  V15690-01_3of3.zip
B53824-01_3of4.zip  V15681-01_1of3.zip  V15684-01_1of3.zip  V15687-01_1of3.zip  V15691-01_1of3.zip
B53824-01_4of4.zip  V15681-01_2of3.zip  V15684-01_2of3.zip  V15687-01_2of3.zip  V15691-01_2of3.zip
B53825-01.zip       V15681-01_3of3.zip  V15684-01_3of3.zip  V15687-01_3of3.zip  V15691-01_3of3.zip
V15679-01_1of3.zip  V15682-01_1of3.zip  V15685-01_1of3.zip  V15688-01_1of2.zip  V17202-01.zip
V15679-01_2of3.zip  V15682-01_2of3.zip  V15685-01_2of3.zip  V15688-01_2of2.zip  V18735-01_1of2.zip
V15679-01_3of3.zip  V15682-01_3of3.zip  V15685-01_3of3.zip  V15689-01.zip       V18735-01_2of2.zip
V15680-01_1of3.zip  V15683-01_1of3.zip  V15686-01_1of3.zip  V15690-01_1of3.zip  V18967-01.zip
}}}


Make sure the checksum is OK for downloaded files
MOS links:
  * MD5 Checksums for R12.1.1 Rapid Install Media [ID 802195.1]

Check
{{{
$ md5sum --check md5sum_Linux64.txt > md5sum_result.txt
}}}

Oracle E-Business Suite Release 12.1.1 Rapid Install Start Here
{{{
# mv B53824-01_* ../oracle_EBS_R12.1.1_linux_x86-64/
# unzip B53824-01_1of4.zip
# unzip B53824-01_2of4.zip
# unzip B53824-01_3of4.zip
# unzip B53824-01_4of4.zip
# mv *.zip ../donez/
  *> startCD
}}}

Oracle E-Business Suite Release 12.1.1 for Linux x86-64 Rapid Install RDBMS
{{{
# mv V15679-01_* ../oracle_EBS_R12.1.1_linux_x86-64/
# ls -1 *.zip | awk '{print "unzip " $0}' > lunzip
# . ./lunzip
# mv *.zip ../donez/
  *> oraDB
}}}

Oracle E-Business Suite Release 12.1.1 for Linux x86-64 Rapid Install Databases
{{{
# mv V1568* ../oracle_EBS_R12.1.1_linux_x86-64/
# ls -1 *.zip | awk '{print "unzip " $0}' > lunzip
# . ./lunzip
replace oraAppDB/dvd.label?
replace oraAppDB/component.label?
# mv *.zip ../donez
  *> oraAppDB oraAS
}}}

Oracle E-Business Suite Release 12.1.1 for Linux x86-64 Rapid Install APPL_TOP
{{{
# mv V1569* ../oracle_EBS_R12.1.1_linux_x86-64/
# ls -1 *.zip | awk '{print "unzip " $0}' > lunzip
# . ./lunzip
  *> oraApps
}}}

== Prepare EBS binaries for installation ==
== Before Installing or Upgrading ==
If the Release 12.1.1 installation or upgrade is performed with the Rapid Install wizard (either a new R12 installation or upgrade from 11i to R12), ensure you have the latest Rapid Install patch as described in Oracle Applications Release Notes, Release 12.1.1 (My Oracle Support Document 798258.1) before you begin your installation or upgrade.

The most current version of the Rapid Install wizard is 12.1.1.13. You can obtain this version by applying Patch 11072566

Now I have:
{{{
# cd /u01/stageR12/startCD/Disk1/rapidwiz
# ./RapidWizVersion
Version 12.1.1.9
}}}

{{{
# cd /Stage12
# md5sum p11072566_R12_GENERIC.zip
2e4a98f9dba7a4c1e2948e83ae031d28  p11072566_R12_GENERIC.zip
# unzip -o p11072566_R12_GENERIC.zip
}}}

{{{
# cd /u01/stageR12/startCD/Disk1/rapidwiz
# ./RapidWizVersion
Version 12.1.1.13
}}}


(back to the main Oracle E-Business Suite Installation and Upgrade Notes Release 12 (12.1.1) for Linux x86-64 [ID 761566.1] )
== Do the actual install (as root) ==

{{{
# unset ENV
# cd /u01/stageR12/startCD/Disk1/rapidwiz
# ./rapidwiz
}}}


#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallingOracleApplications038.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsComponentInstallationReview036.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsConfigurationChoice029.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsDatabaseNode031.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsDatabaseNode032.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsFinish040.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsGlobalSystemSettings030.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsNodeInformation034.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsOracleConfigurationManagerDetails028.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsPostInstallChecks039.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsPreInstallChecks035.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsPrimaryApplicationsNode033.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsWelcome026.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/InstallOracleApplicationsWizardOperation027.png]]

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/OracleApplicationsRapidInstallWizardAlert037.png]]



== Connecting to EBS ==

This is very often the tricky part. First try the proven client configurations:

  * Fresh install of Windows XP Professional SP3 32-bit, that comes with Internet Explorer 6, then the install of JRE 6U7 will be done automatically during opening forms session.

Do not try to run EBS under your favoirate browser yet. It will probably not run for now, but what is worse it will create some wird errors that can be easily considered as EBS installation problems - which they are not.

Common problems when running with JRE 7 and browser incomatibilities are:
  * FRM-92095: Oracle Jnitiator version too low - please install version 1.1.8.2 or higher
  * Error FRM-92129 Registry.dat or FRM-92120 Registry.dat

If this is what you are experiencing see the Troubleschooting section

Login page should be reachable under:

http://jazz.remik.org:8000

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/logon1.PNG]]

login as
sysadmin : sysadmin

== Forms interface ==
After loging as sysadmin in Navigator column go to: System Administrator,

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/sys_adm.PNG]]

then Concurrent section and go to 'Requests'.

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/requests.PNG]]

Here all the magic begins. If this is the firs run, you will be presented with an option to install JRE 6, you have to allow java scrips, pop up windows, etc. And finally (if you are lucky) you are presented with a forms window.

#+ATTR_LaTeX: width=12cm
[[/home/remik/osobiste/docs/oracle/images/EBS1211Install/find_request.PNG]]

Let's call it a day for now.


== Application manager ==
http://jazz.remik.org:8000/OA_HTML/weboam/oam/components$target=VIS

== Basic environment setup ==

Environment Application tier
/u01/oracle/VIS/apps/apps_st/appl/APPSVIS_jazz.env

Environment DB tier
/u01/oracle/VIS/db/tech_st/11.1.0/VIS_jazz.env

Start DB
{{{
$ . /u01/oracle/VIS/db/tech_st/11.1.0/VIS_jazz.env
$ cd $ORACLE_HOME/appsutil/scripts/$CONTEXT_NAME
$ ./addbctl.sh start
$ ./addlnctl.sh start VIS
}}}

APP
{{{
$ . /u01/oracle/VIS/apps/apps_st/appl/APPSVIS_jazz.env
$ cd $INST_TOP/admin/scripts
Start
$ ./adstrtal.sh apps/apps
Stop
$ ./adstpall.sh apps/apps
}}}

Apache logs:
/u01/oracle/VIS/inst/apps/VIS_jazz/logs/ora/10.1.3/Apache

Convienient start/stop scripts available under ~/$HOME/scripto/ebs


== After Installing or Upgrading ==

Still following MOS: Oracle E-Business Suite Installation and Upgrade Notes Release 12 (12.1.1) for Linux x86-64 (Doc ID 761566.1)

Section: AFTER INSTALLING OR UPGRADING

Manually fix database dbf file for Fresh production (PROD) database installs
  *> not required, we already used RapidWizVersion Version 12.1.1.13

Relink Advanced Supply Chain Planning executables (for SLES 10 and 11, Oracle Linux/RHEL 5.4 or higher and Oracle Linux/RHEL 6 only)

Shutdown apps tier.

{{{
$ . app_env
$ mkdir ~/backup
$ cp $AD_TOP/bin/adrelinknew.sh ~/backup/adrelinknew.sh_`date -I`
$ vi $AD_TOP/bin/adrelinknew.sh
replace
CPP_LDFLAGS=' -L$(ORACLE_HOME)/lib -L$(ORACLE_HOME)/lib/stubs -lclntsh'
with
CPP_LDFLAGS=' -L$(ORACLE_HOME)/lib -L$(ORACLE_HOME)/lib/stubs -lclntsh -Wl,--noinhibit-exec'
}}}

{{{
$ adadmin
(all default answers)
system : manager
apps : apps
2.    Maintain Applications Files menu
  #    Relink Applications programs
}}}


== Summary ==

Now we have RDBMS in version 11.1.0.7.0, EBS application stack in version 12.1.1.

= Autoconfig =
== Application tier ==
{{{
$ . $HOME/scripto/ebs/app_env
R11
$ cd $COMMON_TOP/admin/scripts/$CONTEXT_NAME/
R12
$ cd $ADMIN_SCRIPTS_HOME
$ ./adautocfg.sh
}}}

== Database tier ==
{{{
$ . $HOME/scripto/ebs/db_env
$ cd $ORACLE_HOME/appsutil/scripts/$CONTEXT_NAME
$ ./adautocfg.sh
}}}

== Tutorial ==
Autoconfig usues context file to generate configuration files spread all over application or database tier. It is time to introduce the context file. This is just an XML file, found in:

{{{
$ . app_env
$ env | grep CONTEXT_FILE
CONTEXT_FILE=/u01/oracle/VIS/inst/apps/VIS_jazz/appl/admin/VIS_jazz.xml
}}}

For example, there is a variable
<apache_loglevel oa_var="s_apache_loglevel">warn</apache_loglevel>

Which is good for our example because it is rather self exlanatiory - it decides the level at which apache writes its logfile. Usually working with apache you set this kind of variables directly at the apache configuration file. Let's look there too

{{{
$ vi /u01/oracle/VIS/inst/apps/VIS_jazz/ora/10.1.3/Apache/Apache/conf/httpd.conf
}}}

And we find the parameter that sets the log level, namely
LogLevel warn

Lets just see what will happen if we change it there to 'debug'
LogLevel debug

OK, we can restart the app tier and enjoy the debug level. But what will happen if we run the autoconfig now? Lets try it.

{{{
$ . $HOME/scripto/ebs/app_env
$ cd $ADMIN_SCRIPTS_HOME
$ ./adautocfg.sh
}}}

And now again see the apache config file
{{{
$ less /u01/oracle/VIS/inst/apps/VIS_jazz/ora/10.1.3/Apache/Apache/conf/httpd.conf
}}}

Well, we again go back to
LogLevel warn

What has happened? Autoconfig has overwritten our Apache config file. The lesson: if you want change some obvious parameter and want it to be a permanent change - you have to change the appropriate variable in the context file and run autoconfig. Otherwise the change will be overwritten the next time the autoconfig is run.

Autoconfig is run sometimes automatically during application of some EBS patches, so you better keep your configuration clean and avoid 'hacking' configuration files by hand.

How is it done? Looking at the Autoconfig log file we can see:

{{{
$ less /u01/oracle/VIS/inst/apps/VIS_jazz/admin/log/01061802/adconfig.log
source : /u01/oracle/VIS/apps/apps_st/appl/fnd/12.0.0/admin/template/httpd_conf_1013.tmp
dest   : /u01/oracle/VIS/inst/apps/VIS_jazz/ora/10.1.3/Apache/Apache/conf/httpd.conf
backup : /u01/oracle/VIS/inst/apps/VIS_jazz/ora/10.1.3/Apache/Apache/conf/httpd.conf to /u01/oracle/VIS/inst/apps/VIS_jazz/admin/out/01061802/httpd.conf
}}}

What we can interpret as:
  # There is a template of every configuration file generated by Autoconfig. Together with values from Context file the destination file is generated.
2. Before the new destination file is generated the backup is done.

First let us explore the fact that every run of Autoconfig generates backups of every configuration file it intends to overwrite. This is exactly for ocasions where you made some changes directly to configuration file and forgot to update the context file. There is hope, you can restore those changes.

This procedure is rather for emergencies, where after running Autoconfig nothing works any more. Lets look at the directory where the backup is created, hete at:

{{{
$ cd /u01/oracle/VIS/inst/apps/VIS_jazz/admin/out/01061802
}}}

We can see how many different configuration files are managed through Autoconfig. Also there is script with friendly name 'restore.sh'. Running it rolls back the changes done by this Autoconfig run.

Let's do it.
{{{
$ ./restore.sh
}}}

And now again see the apache config file
{{{
$ less /u01/oracle/VIS/inst/apps/VIS_jazz/ora/10.1.3/Apache/Apache/conf/httpd.conf
LogLevel debug
}}}

OK, so we restored the previos version of this (and many others) config files.

== How properly perform the change? ==

Through the Context file of course.

{{{
$ . ~/scripto/ebs/app_env
$ env | grep CONTEXT_FILE
CONTEXT_FILE=/u01/oracle/VIS/inst/apps/VIS_jazz/appl/admin/VIS_jazz.xml
}}}

Let's change the variable to debug
<apache_loglevel oa_var="s_apache_loglevel">warn</apache_loglevel>

{{{
$ cp $CONTEXT_FILE ~/backup/CONTEXT_FILE_`date -I`
$ vi $CONTEXT_FILE
change
<apache_loglevel oa_var="s_apache_loglevel">warn</apache_loglevel>
to
<apache_loglevel oa_var="s_apache_loglevel">debug</apache_loglevel>
}}}

And run the Autoconfig
{{{
$ . $HOME/scripto/ebs/app_env
$ cd $ADMIN_SCRIPTS_HOME
$ ./adautocfg.sh
}}}

The httpd.conf file should have the desired 'debug' value.
{{{
$ less /u01/oracle/VIS/inst/apps/VIS_jazz/ora/10.1.3/Apache/Apache/conf/httpd.conf
LogLevel debug
}}}