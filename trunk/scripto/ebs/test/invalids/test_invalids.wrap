#!/bin/bash
#$Id: _base_script_block.wrap,v 1.1 2012-05-07 13:47:27 remik Exp $
#

# Load usefull functions
if [ ! -f $HOME/scripto/bash/bash_library.sh ]; then
  echo "[error] $HOME/scripto/bash/bash_library.sh not found. Exiting. "
  exit 1
else
  . $HOME/scripto/bash/bash_library.sh
fi

#INFO_MODE=DEBUG
INFO_MODE=INFO

while read LINE
do
  f_user_execute_sql "select count(1) from dba_objects where status != 'VALID';" "apps/apps"
  V_INVALID_BEFORE=$V_EXECUTE_SQL
  
  f_user_execute_sql "select edition_name from dba_objects where object_name='$LINE';" "apps/apps"
  V_EDITION=$V_EXECUTE_SQL
  
  f_user_execute_sql "grant select on $LINE to BOLINF;" "apps/apps"
  V_GRANT_RESULT=$V_EXECUTE_SQL

  f_user_execute_sql "select count(1) from dba_objects where status != 'VALID';" "apps/apps"
  V_INVALID_AFTER=$V_EXECUTE_SQL

  echo "$LINE $V_INVALID_BEFORE $V_EDITION $V_GRANT_RESULT $V_INVALID_AFTER" 
#exit 0
done < tables.lst
